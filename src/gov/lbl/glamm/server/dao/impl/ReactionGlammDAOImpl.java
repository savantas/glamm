package gov.lbl.glamm.server.dao.impl;

import gov.lbl.glamm.client.model.GlammPrimitive.Xref;
import gov.lbl.glamm.client.model.Reaction;
import gov.lbl.glamm.server.GlammDbConnectionPool;
import gov.lbl.glamm.server.dao.ReactionDAO;
import gov.lbl.glamm.shared.GlammUtils;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.HashSet;

public class ReactionGlammDAOImpl implements ReactionDAO {
	
	public static final String GLOBAL_MAP_RXN_IDS				=
		"\"R01635\",\"R05640\",\"R01630\",\"R02735\",\"R05642\",\"R05641\",\"R02734\",\"R01631\",\"R03867\",\"R05644\",\"R02736\",\"R03868\",\"R02739\"," +
		"\"R02351\",\"R02353\",\"R02352\",\"R01639\",\"R08735\",\"R08734\",\"R08733\",\"R05634\",\"R05636\",\"R05637\",\"R05639\",\"R02740\",\"R07775\"," +
		"\"R01626\",\"R03877\",\"R01624\",\"R07772\",\"R02748\",\"R01621\",\"R05633\",\"R03878\",\"R07771\",\"R05632\",\"R07774\",\"R07773\",\"R02340\"," +
		"\"R07770\",\"R01629\",\"R08716\",\"R07768\",\"R05629\",\"R07769\",\"R02757\",\"R02756\",\"R03889\",\"R05622\",\"R05621\",\"R07767\",\"R07766\"," +
		"\"R01613\",\"R01615\",\"R01616\",\"R02371\",\"R02372\",\"R05617\",\"R05618\",\"R03892\",\"R03891\",\"R02765\",\"R01608\",\"R08738\",\"R08739\"," +
		"\"R02362\",\"R08350\",\"R02360\",\"R08740\",\"R08743\",\"R02356\",\"R05605\",\"R05606\",\"R00095\",\"R00093\",\"R02311\",\"R01676\",\"R01681\"," +
		"\"R03087\",\"R01682\",\"R03089\",\"R02302\",\"R02301\",\"R03084\",\"R03083\",\"R02307\",\"R02705\",\"R00084\",\"R01665\",\"R02701\",\"R01663\"," +
		"\"R03077\",\"R02331\",\"R02332\",\"R02719\",\"R01652\",\"R01655\",\"R01658\",\"R02328\",\"R02327\",\"R00999\",\"R02326\",\"R00996\",\"R02325\"," +
		"\"R02320\",\"R02729\",\"R02723\",\"R01641\",\"R01648\",\"R02722\",\"R07705\",\"R07704\",\"R03098\",\"R02317\",\"R02315\",\"R02313\",\"R04509\"," +
		"\"R01179\",\"R03045\",\"R00586\",\"R00585\",\"R00588\",\"R01186\",\"R01187\",\"R01183\",\"R01168\",\"R00582\",\"R03036\",\"R03035\",\"R00579\"," +
		"\"R00578\",\"R00575\",\"R01175\",\"R01176\",\"R01177\",\"R01171\",\"R01174\",\"R03067\",\"R00570\",\"R00571\",\"R03064\",\"R03066\",\"R00573\"," +
		"\"R00566\",\"R00565\",\"R00567\",\"R03403\",\"R03402\",\"R03401\",\"R03058\",\"R03059\",\"R03057\",\"R03055\",\"R03812\",\"R01688\",\"R00552\"," +
		"\"R06620\",\"R00557\",\"R01196\",\"R01197\",\"R08770\",\"R00551\",\"R08771\",\"R04549\",\"R02783\",\"R02782\",\"R08776\",\"R03435\",\"R08777\"," +
		"\"R08778\",\"R03437\",\"R08772\",\"R03438\",\"R08773\",\"R08774\",\"R08775\",\"R00549\",\"R08769\",\"R03444\",\"R03443\",\"R03820\",\"R02777\"," +
		"\"R03822\",\"R03821\",\"R04550\",\"R03824\",\"R04536\",\"R07396\",\"R00540\",\"R08760\",\"R04537\",\"R04534\",\"R07394\",\"R04535\",\"R07393\"," +
		"\"R07392\",\"R07390\",\"R02794\",\"R03425\",\"R08768\",\"R03424\",\"R03429\",\"R03427\",\"R08761\",\"R03433\",\"R08759\",\"R03430\",\"R08758\"," +
		"\"R03833\",\"R03832\",\"R02786\",\"R03831\",\"R04544\",\"R04543\",\"R00530\",\"R00531\",\"R04541\",\"R03834\",\"R03026\",\"R03025\",\"R03851\"," +
		"\"R03457\",\"R03458\",\"R03459\",\"R03464\",\"R00529\",\"R03460\",\"R03462\",\"R03845\",\"R00521\",\"R04533\",\"R00522\",\"R03018\",\"R02797\"," +
		"\"R03015\",\"R03013\",\"R08781\",\"R08785\",\"R03445\",\"R03455\",\"R00519\",\"R03454\",\"R00516\",\"R00517\",\"R04522\",\"R03858\",\"R03857\"," +
		"\"R03009\",\"R03856\",\"R07799\",\"R00512\",\"R03005\",\"R00513\",\"R04464\",\"R04463\",\"R03353\",\"R03354\",\"R03355\",\"R03350\",\"R03351\"," +
		"\"R05126\",\"R05124\",\"R05125\",\"R05123\",\"R03348\",\"R00901\",\"R00905\",\"R04457\",\"R00907\",\"R00908\",\"R04475\",\"R00502\",\"R04472\"," +
		"\"R03366\",\"R03362\",\"R03363\",\"R01220\",\"R03361\",\"R01213\",\"R01215\",\"R07364\",\"R01214\",\"R01217\",\"R01218\",\"R04061\",\"R07363\"," +
		"\"R04469\",\"R04440\",\"R04441\",\"R04444\",\"R04445\",\"R01230\",\"R01231\",\"R07379\",\"R01229\",\"R04053\",\"R01227\",\"R01226\",\"R01225\"," +
		"\"R07376\",\"R01224\",\"R07377\",\"R04435\",\"R04051\",\"R04452\",\"R04456\",\"R01244\",\"R00104\",\"R07387\",\"R00102\",\"R07384\",\"R04448\"," +
		"\"R03102\",\"R03103\",\"R07381\",\"R01251\",\"R03394\",\"R01255\",\"R03393\",\"R01253\",\"R01252\",\"R03390\",\"R06722\",\"R01248\",\"R01245\"," +
		"\"R01260\",\"R06733\",\"R06732\",\"R06728\",\"R07324\",\"R01274\",\"R04095\",\"R04097\",\"R01269\",\"R01267\",\"R01268\",\"R01286\",\"R01288\"," +
		"\"R01287\",\"R01281\",\"R01280\",\"R04085\",\"R04089\",\"R01278\",\"R01279\",\"R00158\",\"R06223\",\"R00156\",\"R07809\",\"R00987\",\"R00985\"," +
		"\"R00986\",\"R07801\",\"R07802\",\"R07807\",\"R07808\",\"R07805\",\"R07806\",\"R05598\",\"R05597\",\"R05599\",\"R05594\",\"R07811\",\"R07810\"," +
		"\"R00161\",\"R00970\",\"R00974\",\"R06238\",\"R05198\",\"R00977\",\"R00978\",\"R07812\",\"R05196\",\"R07813\",\"R07814\",\"R07815\",\"R07816\"," +
		"\"R07817\",\"R07818\",\"R07819\",\"R07822\",\"R07821\",\"R00173\",\"R00174\",\"R00177\",\"R05186\",\"R00965\",\"R00966\",\"R00964\",\"R00962\"," +
		"\"R00178\",\"R05180\",\"R05181\",\"R00967\",\"R05185\",\"R00968\",\"R05575\",\"R05578\",\"R00185\",\"R00183\",\"R00181\",\"R05177\",\"R07302\"," +
		"\"R06259\",\"R00954\",\"R06258\",\"R00955\",\"R05176\",\"R00189\",\"R00956\",\"R00959\",\"R05584\",\"R07800\",\"R00190\",\"R05588\",\"R05587\"," +
		"\"R00196\",\"R00199\",\"R05581\",\"R00192\",\"R00194\",\"R00948\",\"R04030\",\"R00946\",\"R00945\",\"R06260\",\"R06261\",\"R06262\",\"R06263\"," +
		"\"R00940\",\"R04037\",\"R06264\",\"R00114\",\"R06265\",\"R06266\",\"R04035\",\"R06267\",\"R00112\",\"R06268\",\"R06269\",\"R00943\",\"R04031\"," +
		"\"R02264\",\"R08370\",\"R02265\",\"R02266\",\"R02267\",\"R08374\",\"R08379\",\"R00935\",\"R06270\",\"R05150\",\"R00937\",\"R00936\",\"R00939\"," +
		"\"R05559\",\"R06271\",\"R05558\",\"R00124\",\"R04025\",\"R04027\",\"R00127\",\"R02269\",\"R02268\",\"R00130\",\"R08362\",\"R00131\",\"R04017\"," +
		"\"R08364\",\"R02272\",\"R05563\",\"R05560\",\"R05561\",\"R06282\",\"R06284\",\"R00927\",\"R00926\",\"R05140\",\"R02003\",\"R05145\",\"R05146\"," +
		"\"R05149\",\"R00134\",\"R02282\",\"R04009\",\"R08396\",\"R02283\",\"R04007\",\"R02285\",\"R02287\",\"R02288\",\"R06295\",\"R06293\",\"R06294\"," +
		"\"R02013\",\"R06291\",\"R05130\",\"R02014\",\"R06292\",\"R02011\",\"R00149\",\"R04001\",\"R05138\",\"R05137\",\"R06297\",\"R05136\",\"R06298\"," +
		"\"R02296\",\"R05129\",\"R02297\",\"R02007\",\"R02006\",\"R02291\",\"R02292\",\"R02008\",\"R01737\",\"R01739\",\"R02494\",\"R02493\",\"R01730\"," +
		"\"R01731\",\"R02874\",\"R07888\",\"R07887\",\"R08219\",\"R02488\",\"R01728\",\"R05732\",\"R05731\",\"R01724\",\"R07869\",\"R02479\",\"R02472\"," +
		"\"R02474\",\"R01759\",\"R02473\",\"R08204\",\"R01758\",\"R08203\",\"R05765\",\"R03989\",\"R01754\",\"R03990\",\"R01761\",\"R03991\",\"R02861\"," +
		"\"R02466\",\"R02467\",\"R07891\",\"R07890\",\"R05750\",\"R07897\",\"R02864\",\"R01747\",\"R07896\",\"R07899\",\"R01745\",\"R07898\",\"R02869\"," +
		"\"R07893\",\"R07892\",\"R07895\",\"R01741\",\"R07894\",\"R05745\",\"R08209\",\"R07889\",\"R02872\",\"R02458\",\"R08603\",\"R02834\",\"R01773\"," +
		"\"R07840\",\"R01776\",\"R07056\",\"R02836\",\"R01775\",\"R01777\",\"R02832\",\"R02451\",\"R07050\",\"R07051\",\"R02454\",\"R07055\",\"R07052\"," +
		"\"R07053\",\"R02445\",\"R02444\",\"R02446\",\"R02846\",\"R01769\",\"R02843\",\"R01768\",\"R07063\",\"R07064\",\"R02439\",\"R07824\",\"R07823\"," +
		"\"R07826\",\"R07825\",\"R01771\",\"R01799\",\"R07038\",\"R07863\",\"R02811\",\"R01795\",\"R07860\",\"R02422\",\"R02425\",\"R07859\",\"R02821\"," +
		"\"R01788\",\"R01787\",\"R07045\",\"R01786\",\"R07046\",\"R07048\",\"R07041\",\"R02829\",\"R07042\",\"R07043\",\"R02827\",\"R07044\",\"R02421\"," +
		"\"R02413\",\"R02412\",\"R02415\",\"R05703\",\"R01793\",\"R01794\",\"R01791\",\"R01790\",\"R04606\",\"R00694\",\"R03539\",\"R03928\",\"R00685\"," +
		"\"R00689\",\"R00688\",\"R03933\",\"R00674\",\"R06740\",\"R06741\",\"R03932\",\"R00678\",\"R00677\",\"R03905\",\"R03521\",\"R03509\",\"R03508\"," +
		"\"R03503\",\"R08689\",\"R03504\",\"R01296\",\"R03918\",\"R01298\",\"R01293\",\"R03919\",\"R01295\",\"R01290\",\"R04620\",\"R00697\",\"R00650\"," +
		"\"R00640\",\"R03966\",\"R03968\",\"R00643\",\"R00647\",\"R00648\",\"R04639\",\"R03982\",\"R04640\",\"R03973\",\"R03555\",\"R03556\",\"R04666\"," +
		"\"R00670\",\"R04667\",\"R00672\",\"R00667\",\"R04672\",\"R00669\",\"R00662\",\"R04673\",\"R03947\",\"R03948\",\"R03560\",\"R00661\",\"R04657\"," +
		"\"R00660\",\"R04658\",\"R00658\",\"R03953\",\"R05219\",\"R05218\",\"R01354\",\"R05217\",\"R01351\",\"R00220\",\"R04560\",\"R04566\",\"R07492\"," +
		"\"R07493\",\"R07494\",\"R04559\",\"R07495\",\"R04558\",\"R04170\",\"R07490\",\"R04173\",\"R07491\",\"R05221\",\"R04175\",\"R05222\",\"R00216\"," +
		"\"R00217\",\"R05220\",\"R07496\",\"R05225\",\"R07497\",\"R00212\",\"R05226\",\"R07498\",\"R05223\",\"R05224\",\"R00214\",\"R01364\",\"R05207\"," +
		"\"R00608\",\"R00605\",\"R01360\",\"R00604\",\"R01361\",\"R00602\",\"R04573\",\"R04571\",\"R04576\",\"R04568\",\"R04567\",\"R04162\",\"R00228\"," +
		"\"R00229\",\"R00616\",\"R00615\",\"R00618\",\"R00617\",\"R03470\",\"R00619\",\"R03471\",\"R03472\",\"R05239\",\"R05238\",\"R00610\",\"R04587\"," +
		"\"R00611\",\"R07470\",\"R07471\",\"R07473\",\"R01325\",\"R07474\",\"R01324\",\"R05243\",\"R04199\",\"R03469\",\"R01326\",\"R04198\",\"R04591\"," +
		"\"R00210\",\"R05227\",\"R05229\",\"R04594\",\"R00209\",\"R07483\",\"R07484\",\"R07481\",\"R07482\",\"R01334\",\"R05234\",\"R00200\",\"R05237\"," +
		"\"R00206\",\"R00207\",\"R03478\",\"R05233\",\"R04952\",\"R01398\",\"R04953\",\"R01397\",\"R04954\",\"R04955\",\"R01394\",\"R04956\",\"R07449\"," +
		"\"R04957\",\"R06318\",\"R04958\",\"R01392\",\"R04959\",\"R06326\",\"R07459\",\"R06323\",\"R04960\",\"R06322\",\"R04962\",\"R01388\",\"R04961\"," +
		"\"R07454\",\"R07451\",\"R07450\",\"R06832\",\"R06831\",\"R04965\",\"R04966\",\"R04963\",\"R04964\",\"R04969\",\"R04967\",\"R04968\",\"R07469\"," +
		"\"R07468\",\"R07467\",\"R07466\",\"R07464\",\"R06332\",\"R04970\",\"R07462\",\"R07461\",\"R06843\",\"R06842\",\"R06841\",\"R01372\",\"R07427\"," +
		"\"R07428\",\"R07429\",\"R01373\",\"R07431\",\"R07430\",\"R05202\",\"R01366\",\"R06301\",\"R07437\",\"R07436\",\"R06835\",\"R06833\",\"R06834\"," +
		"\"R06851\",\"R01381\",\"R06306\",\"R06305\",\"R01383\",\"R06308\",\"R01385\",\"R01384\",\"R04985\",\"R01387\",\"R01377\",\"R07444\",\"R04993\"," +
		"\"R06310\",\"R06311\",\"R07448\",\"R06844\",\"R06845\",\"R06847\",\"R07440\",\"R06848\",\"R06361\",\"R07902\",\"R07414\",\"R07415\",\"R07413\"," +
		"\"R06364\",\"R07406\",\"R07405\",\"R04919\",\"R05692\",\"R02801\",\"R05290\",\"R07916\",\"R05291\",\"R07917\",\"R07918\",\"R05294\",\"R05295\"," +
		"\"R05292\",\"R05293\",\"R05298\",\"R07919\",\"R07420\",\"R04920\",\"R04921\",\"R07417\",\"R04923\",\"R07419\",\"R07418\",\"R07920\",\"R04115\"," +
		"\"R00277\",\"R00278\",\"R04109\",\"R00286\",\"R06351\",\"R07939\",\"R00289\",\"R06354\",\"R04101\",\"R06357\",\"R07404\",\"R00291\",\"R04947\"," +
		"\"R07940\",\"R07943\",\"R05264\",\"R05263\",\"R00259\",\"R00258\",\"R01300\",\"R00257\",\"R05267\",\"R01301\",\"R00256\",\"R01302\",\"R05269\"," +
		"\"R05646\",\"R05645\",\"R05648\",\"R05647\",\"R05649\",\"R05650\",\"R05652\",\"R00262\",\"R01310\",\"R00260\",\"R00261\",\"R01317\",\"R00267\"," +
		"\"R04125\",\"R00268\",\"R05661\",\"R05662\",\"R05665\",\"R05666\",\"R05663\",\"R05664\",\"R01321\",\"R04117\",\"R01320\",\"R00271\",\"R00235\"," +
		"\"R05289\",\"R00233\",\"R02379\",\"R05286\",\"R00239\",\"R05285\",\"R00238\",\"R04152\",\"R05288\",\"R00237\",\"R05287\",\"R05282\",\"R04151\"," +
		"\"R05284\",\"R01701\",\"R01700\",\"R01702\",\"R01706\",\"R01709\",\"R00243\",\"R01708\",\"R04147\",\"R04148\",\"R00248\",\"R05276\",\"R05275\"," +
		"\"R04143\",\"R04144\",\"R01710\",\"R05688\",\"R01714\",\"R05681\",\"R01711\",\"R01717\",\"R04903\",\"R04904\",\"R01715\",\"R04138\",\"R00253\"," +
		"\"R04900\",\"R00397\",\"R05835\",\"R05838\",\"R07977\",\"R00774\",\"R00782\",\"R07159\",\"R05840\",\"R05842\",\"R05824\",\"R07967\",\"R07969\"," +
		"\"R07968\",\"R08915\",\"R08914\",\"R07973\",\"R07974\",\"R07975\",\"R07976\",\"R00376\",\"R07970\",\"R00377\",\"R00378\",\"R07168\",\"R07971\"," +
		"\"R07972\",\"R05815\",\"R05814\",\"R07956\",\"R07955\",\"R00375\",\"R05810\",\"R08100\",\"R00374\",\"R05812\",\"R00372\",\"R07959\",\"R03617\"," +
		"\"R00751\",\"R00750\",\"R08107\",\"R00755\",\"R03610\",\"R00754\",\"R03611\",\"R08540\",\"R01895\",\"R07179\",\"R07960\",\"R08542\",\"R00366\"," +
		"\"R01896\",\"R07178\",\"R08541\",\"R01899\",\"R08549\",\"R07945\",\"R03608\",\"R08110\",\"R01890\",\"R01891\",\"R00762\",\"R08112\",\"R08113\"," +
		"\"R08115\",\"R00766\",\"R08116\",\"R05809\",\"R00765\",\"R05808\",\"R00768\",\"R05807\",\"R08109\",\"R08553\",\"R00355\",\"R00357\",\"R01883\"," +
		"\"R07954\",\"R02103\",\"R06885\",\"R06886\",\"R02106\",\"R02107\",\"R02108\",\"R02911\",\"R06883\",\"R02914\",\"R01880\",\"R01881\",\"R06075\"," +
		"\"R02919\",\"R01876\",\"R08567\",\"R01878\",\"R05884\",\"R08566\",\"R07199\",\"R02110\",\"R02112\",\"R02920\",\"R06896\",\"R06895\",\"R08965\"," +
		"\"R06893\",\"R06892\",\"R02922\",\"R01870\",\"R05865\",\"R01867\",\"R02501\",\"R01868\",\"R01863\",\"R02506\",\"R08570\",\"R08571\",\"R08572\"," +
		"\"R02101\",\"R02100\",\"R01869\",\"R02125\",\"R02126\",\"R05858\",\"R02520\",\"R05854\",\"R06095\",\"R05864\",\"R01857\",\"R06855\",\"R01858\"," +
		"\"R01859\",\"R02135\",\"R06858\",\"R02134\",\"R06859\",\"R02519\",\"R02518\",\"R05847\",\"R02908\",\"R05845\",\"R05846\",\"R05843\",\"R05844\"," +
		"\"R05853\",\"R05852\",\"R01840\",\"R05850\",\"R08599\",\"R01845\",\"R02521\",\"R02124\",\"R02123\",\"R06867\",\"R02534\",\"R02535\",\"R00305\"," +
		"\"R02532\",\"R02533\",\"R04311\",\"R02536\",\"R04305\",\"R03243\",\"R02541\",\"R03245\",\"R03677\",\"R03674\",\"R03673\",\"R03672\",\"R04301\"," +
		"\"R04300\",\"R03231\",\"R03232\",\"R02556\",\"R02557\",\"R02555\",\"R03262\",\"R03263\",\"R03260\",\"R03696\",\"R03693\",\"R04798\",\"R06421\"," +
		"\"R02568\",\"R03254\",\"R02571\",\"R02570\",\"R00344\",\"R00343\",\"R00345\",\"R02581\",\"R00351\",\"R00352\",\"R03288\",\"R02583\",\"R03269\"," +
		"\"R00332\",\"R03630\",\"R03626\",\"R05402\",\"R00341\",\"R00342\",\"R02593\",\"R02596\",\"R08503\",\"R00330\",\"R00310\",\"R00315\",\"R03652\"," +
		"\"R03651\",\"R03293\",\"R03291\",\"R00320\",\"R03295\",\"R04861\",\"R04863\",\"R04862\",\"R07558\",\"R04858\",\"R04859\",\"R01497\",\"R04854\"," +
		"\"R04855\",\"R05316\",\"R01494\",\"R04264\",\"R01498\",\"R04872\",\"R05314\",\"R05313\",\"R04870\",\"R05309\",\"R07559\",\"R04869\",\"R04276\"," +
		"\"R04237\",\"R05301\",\"R07575\",\"R04247\",\"R03300\",\"R04845\",\"R04846\",\"R04847\",\"R05368\",\"R05369\",\"R05366\",\"R05367\",\"R07599\"," +
		"\"R01449\",\"R05365\",\"R05362\",\"R01447\",\"R05360\",\"R03310\",\"R05361\",\"R03311\",\"R03307\",\"R04223\",\"R04224\",\"R04225\",\"R03302\"," +
		"\"R03304\",\"R03595\",\"R01451\",\"R05355\",\"R05356\",\"R01454\",\"R01457\",\"R01456\",\"R05351\",\"R05353\",\"R03599\",\"R05354\",\"R03321\"," +
		"\"R05350\",\"R04231\",\"R03314\",\"R04230\",\"R03313\",\"R05349\",\"R05348\",\"R01463\",\"R04880\",\"R04881\",\"R05341\",\"R04882\",\"R01468\"," +
		"\"R04883\",\"R05347\",\"R04884\",\"R01466\",\"R03327\",\"R03326\",\"R03328\",\"R04203\",\"R01473\",\"R04891\",\"R04892\",\"R04890\",\"R05332\"," +
		"\"R01476\",\"R04893\",\"R04894\",\"R01478\",\"R04204\",\"R04209\",\"R04208\",\"R04210\",\"R01483\",\"R04889\",\"R04888\",\"R04887\",\"R04886\"," +
		"\"R01481\",\"R01482\",\"R01826\",\"R02022\",\"R01825\",\"R02024\",\"R01827\",\"R01829\",\"R02020\",\"R01015\",\"R05795\",\"R01018\",\"R00706\"," +
		"\"R08172\",\"R00705\",\"R08173\",\"R01409\",\"R00703\",\"R08171\",\"R01021\",\"R00709\",\"R00708\",\"R00707\",\"R06021\",\"R02019\",\"R01401\"," +
		"\"R06024\",\"R02968\",\"R01402\",\"R06025\",\"R00702\",\"R02962\",\"R06026\",\"R06973\",\"R02963\",\"R02017\",\"R06975\",\"R06029\",\"R02035\"," +
		"\"R06957\",\"R02036\",\"R01838\",\"R01837\",\"R02034\",\"R01836\",\"R06954\",\"R02032\",\"R02030\",\"R01006\",\"R01830\",\"R01005\",\"R01003\"," +
		"\"R01009\",\"R05392\",\"R06031\",\"R08165\",\"R08166\",\"R01011\",\"R02957\",\"R06033\",\"R05399\",\"R01416\",\"R02029\",\"R06963\",\"R05398\"," +
		"\"R05397\",\"R02026\",\"R01415\",\"R06962\",\"R06947\",\"R01431\",\"R06944\",\"R06943\",\"R06946\",\"R01805\",\"R01800\",\"R01802\",\"R01801\"," +
		"\"R01039\",\"R08197\",\"R02038\",\"R06950\",\"R05384\",\"R05387\",\"R06953\",\"R05386\",\"R02941\",\"R05389\",\"R01422\",\"R05388\",\"R01819\"," +
		"\"R02051\",\"R01818\",\"R02057\",\"R01815\",\"R02055\",\"R01814\",\"R02056\",\"R01813\",\"R01034\",\"R05372\",\"R05371\",\"R05370\",\"R06941\"," +
		"\"R07501\",\"R06942\",\"R07500\",\"R07503\",\"R05374\",\"R07502\",\"R01434\",\"R05378\",\"R01432\",\"R02933\",\"R01433\",\"R02061\",\"R02060\"," +
		"\"R04819\",\"R04818\",\"R04817\",\"R07507\",\"R07506\",\"R07505\",\"R04813\",\"R07504\",\"R02068\",\"R02063\",\"R04812\",\"R04811\",\"R04810\"," +
		"\"R07509\",\"R07508\",\"R02064\",\"R00740\",\"R00746\",\"R00744\",\"R00747\",\"R07111\",\"R04825\",\"R04824\",\"R02078\",\"R04826\",\"R04823\"," +
		"\"R07110\",\"R00731\",\"R00732\",\"R00733\",\"R00734\",\"R07108\",\"R07109\",\"R08122\",\"R08121\",\"R04286\",\"R04285\",\"R02080\",\"R02082\"," +
		"\"R02085\",\"R02089\",\"R02991\",\"R02088\",\"R02990\",\"R06004\",\"R06006\",\"R07531\",\"R02988\",\"R02989\",\"R07530\",\"R00729\",\"R01001\"," +
		"\"R00727\",\"R00726\",\"R02090\",\"R04807\",\"R04806\",\"R04809\",\"R02094\",\"R02093\",\"R02091\",\"R02098\",\"R02097\",\"R02096\",\"R04800\"," +
		"\"R04292\",\"R04804\",\"R00710\",\"R00711\",\"R00713\",\"R02978\",\"R06010\",\"R00714\",\"R00715\",\"R00716\",\"R00717\",\"R03737\",\"R03738\"," +
		"\"R00878\",\"R02203\",\"R00877\",\"R05939\",\"R02205\",\"R00875\",\"R02204\",\"R05936\",\"R05935\",\"R00490\",\"R05938\",\"R05937\",\"R05932\"," +
		"\"R05931\",\"R00494\",\"R00489\",\"R05940\",\"R07299\",\"R05941\",\"R02211\",\"R05030\",\"R03724\",\"R00883\",\"R00885\",\"R03720\",\"R00889\"," +
		"\"R05929\",\"R00888\",\"R05928\",\"R05927\",\"R08429\",\"R05926\",\"R00481\",\"R05925\",\"R00480\",\"R00483\",\"R05922\",\"R00485\",\"R05921\"," +
		"\"R05920\",\"R00475\",\"R08432\",\"R02604\",\"R05930\",\"R08434\",\"R05048\",\"R00479\",\"R02600\",\"R05046\",\"R02601\",\"R02201\",\"R08430\"," +
		"\"R02606\",\"R01090\",\"R00899\",\"R01092\",\"R00897\",\"R00896\",\"R00895\",\"R00894\",\"R00893\",\"R03719\",\"R05954\",\"R05953\",\"R05956\"," +
		"\"R03718\",\"R05955\",\"R05958\",\"R05957\",\"R05959\",\"R05960\",\"R05962\",\"R03192\",\"R03191\",\"R03194\",\"R03193\",\"R05945\",\"R05943\"," +
		"\"R03197\",\"R05942\",\"R05949\",\"R03199\",\"R05948\",\"R08408\",\"R05947\",\"R05946\",\"R08414\",\"R00497\",\"R05951\",\"R05952\",\"R05950\"," +
		"\"R07280\",\"R01073\",\"R05979\",\"R01072\",\"R02640\",\"R01074\",\"R01077\",\"R05975\",\"R05976\",\"R05977\",\"R01078\",\"R07701\",\"R01071\"," +
		"\"R06985\",\"R01070\",\"R02253\",\"R06977\",\"R06978\",\"R05075\",\"R02255\",\"R06979\",\"R05074\",\"R02250\",\"R05071\",\"R05070\",\"R02251\"," +
		"\"R02636\",\"R05983\",\"R05982\",\"R05985\",\"R01974\",\"R05984\",\"R01975\",\"R01976\",\"R05981\",\"R01978\",\"R05980\",\"R01086\",\"R01085\"," +
		"\"R05968\",\"R01083\",\"R05969\",\"R05967\",\"R01088\",\"R05964\",\"R05965\",\"R02239\",\"R06990\",\"R01082\",\"R02237\",\"R09070\",\"R02235\"," +
		"\"R09071\",\"R02236\",\"R06989\",\"R02245\",\"R05085\",\"R01968\",\"R01969\",\"R02241\",\"R05081\",\"R02240\",\"R02649\",\"R05973\",\"R01960\"," +
		"\"R06583\",\"R05972\",\"R06584\",\"R05971\",\"R05970\",\"R05089\",\"R01967\",\"R06197\",\"R01056\",\"R06198\",\"R09068\",\"R09067\",\"R09066\"," +
		"\"R02619\",\"R05050\",\"R05053\",\"R05052\",\"R05055\",\"R05057\",\"R05056\",\"R01993\",\"R05059\",\"R05058\",\"R01049\",\"R09069\",\"R02615\"," +
		"\"R01068\",\"R05988\",\"R01067\",\"R05989\",\"R01990\",\"R05986\",\"R05987\",\"R01063\",\"R02630\",\"R01061\",\"R02215\",\"R02216\",\"R02213\"," +
		"\"R02219\",\"R06189\",\"R02217\",\"R06187\",\"R05060\",\"R05064\",\"R02221\",\"R02220\",\"R05068\",\"R05992\",\"R01989\",\"R05991\",\"R05066\"," +
		"\"R05990\",\"R01987\",\"R01982\",\"R01058\",\"R01983\",\"R05069\",\"R00401\",\"R02678\",\"R02675\",\"R00405\",\"R00408\",\"R04696\",\"R04695\"," +
		"\"R04697\",\"R04692\",\"R04691\",\"R04690\",\"R03140\",\"R04404\",\"R04405\",\"R02687\",\"R03126\",\"R02689\",\"R04682\",\"R04681\",\"R06537\"," +
		"\"R06538\",\"R03130\",\"R02691\",\"R02655\",\"R02656\",\"R00425\",\"R06578\",\"R04430\",\"R06576\",\"R04432\",\"R00420\",\"R02657\",\"R02658\"," +
		"\"R06572\",\"R00428\",\"R04426\",\"R04427\",\"R04428\",\"R03123\",\"R04429\",\"R02662\",\"R02661\",\"R06569\",\"R03124\",\"R02665\",\"R00416\"," +
		"\"R03105\",\"R00414\",\"R02668\",\"R00412\",\"R04420\",\"R04699\",\"R00418\",\"R03110\",\"R04413\",\"R06558\",\"R03783\",\"R00443\",\"R00442\"," +
		"\"R00447\",\"R00446\",\"R06513\",\"R03189\",\"R03184\",\"R03185\",\"R00451\",\"R03186\",\"R03187\",\"R03181\",\"R03182\",\"R03776\",\"R03775\"," +
		"\"R03778\",\"R03777\",\"R00432\",\"R00431\",\"R05000\",\"R00435\",\"R03177\",\"R03178\",\"R00441\",\"R03174\",\"R03172\",\"R05500\",\"R05501\"," +
		"\"R05504\",\"R05503\",\"R05502\",\"R05507\",\"R00469\",\"R06534\",\"R00468\",\"R00465\",\"R00466\",\"R00471\",\"R05911\",\"R00472\",\"R05912\"," +
		"\"R06529\",\"R03165\",\"R05910\",\"R06528\",\"R05915\",\"R06527\",\"R05916\",\"R06526\",\"R05913\",\"R06525\",\"R05914\",\"R05919\",\"R05917\"," +
		"\"R05918\",\"R05511\",\"R03161\",\"R00459\",\"R00457\",\"R03153\",\"R06519\",\"R00462\",\"R03157\",\"R06514\",\"R03158\",\"R06517\",\"R06516\"," +
		"\"R05907\",\"R05908\",\"R05909\",\"R07695\",\"R05422\",\"R07696\",\"R07692\",\"R04361\",\"R04365\",\"R05416\",\"R05417\",\"R05414\",\"R05415\"," +
		"\"R04360\",\"R05418\",\"R05411\",\"R05413\",\"R04372\",\"R04377\",\"R04723\",\"R05403\",\"R04724\",\"R05404\",\"R05406\",\"R04371\",\"R05408\"," +
		"\"R04725\",\"R05409\",\"R04726\",\"R04740\",\"R05446\",\"R04742\",\"R07675\",\"R05444\",\"R04741\",\"R07674\",\"R05443\",\"R05442\",\"R05441\"," +
		"\"R05440\",\"R07678\",\"R06601\",\"R04386\",\"R04737\",\"R04738\",\"R04739\",\"R05439\",\"R04753\",\"R04751\",\"R05434\",\"R06604\",\"R06612\"," +
		"\"R04749\",\"R05429\",\"R04747\",\"R04390\",\"R04748\",\"R04745\",\"R04746\",\"R04743\",\"R04744\",\"R05428\",\"R03210\",\"R04761\",\"R01595\"," +
		"\"R04754\",\"R01596\",\"R01593\",\"R04759\",\"R01590\",\"R03208\",\"R04321\",\"R04323\",\"R03209\",\"R03220\",\"R04326\",\"R04325\",\"R03223\"," +
		"\"R03222\",\"R05450\",\"R05451\",\"R04768\",\"R05447\",\"R04769\",\"R03217\",\"R05481\",\"R01567\",\"R05489\",\"R01566\",\"R01565\",\"R05487\"," +
		"\"R04786\",\"R05488\",\"R04780\",\"R05483\",\"R01570\",\"R04779\",\"R03200\",\"R04347\",\"R05476\",\"R05477\",\"R01579\",\"R04787\",\"R04355\"," +
		"\"R08080\",\"R08070\",\"R05891\",\"R01920\",\"R05892\",\"R05893\",\"R01158\",\"R01157\",\"R02160\",\"R02164\",\"R07603\",\"R01926\",\"R07604\"," +
		"\"R01547\",\"R02158\",\"R01548\",\"R01549\",\"R06165\",\"R00014\",\"R08079\",\"R06167\",\"R00013\",\"R06168\",\"R08077\",\"R08078\",\"R06162\"," +
		"\"R01166\",\"R06163\",\"R01167\",\"R00806\",\"R06164\",\"R00805\",\"R08073\",\"R00802\",\"R07215\",\"R01148\",\"R01146\",\"R07618\",\"R00031\"," +
		"\"R01563\",\"R00032\",\"R01561\",\"R01939\",\"R01560\",\"R01938\",\"R01937\",\"R01936\",\"R01559\",\"R05497\",\"R00028\",\"R01558\",\"R05494\"," +
		"\"R01555\",\"R00024\",\"R05499\",\"R05498\",\"R08064\",\"R01156\",\"R01153\",\"R01154\",\"R01152\",\"R06171\",\"R05491\",\"R08063\",\"R05490\"," +
		"\"R08499\",\"R01135\",\"R01138\",\"R07200\",\"R01940\",\"R01137\",\"R01943\",\"R01942\",\"R02142\",\"R01522\",\"R01523\",\"R02137\",\"R01526\"," +
		"\"R01528\",\"R08051\",\"R01529\",\"R01142\",\"R08053\",\"R01127\",\"R01951\",\"R01126\",\"R01956\",\"R01954\",\"R05099\",\"R01128\",\"R01959\"," +
		"\"R01541\",\"R05092\",\"R01540\",\"R05090\",\"R06156\",\"R00005\",\"R06155\",\"R07600\",\"R01538\",\"R07602\",\"R07601\",\"R02147\",\"R01130\"," +
		"\"R00813\",\"R00818\",\"R00817\",\"R06153\",\"R01132\",\"R07263\",\"R00066\",\"R07262\",\"R07647\",\"R01117\",\"R01121\",\"R06120\",\"R01123\"," +
		"\"R01122\",\"R00847\",\"R06128\",\"R06127\",\"R00841\",\"R01500\",\"R00073\",\"R01108\",\"R01519\",\"R01518\",\"R01514\",\"R00833\",\"R01513\"," +
		"\"R00068\",\"R01512\",\"R07663\",\"R00830\",\"R01903\",\"R01904\",\"R02189\",\"R01905\",\"R00045\",\"R01908\",\"R01909\",\"R01900\",\"R00861\"," +
		"\"R00036\",\"R00866\",\"R00867\",\"R02199\",\"R04705\",\"R02197\",\"R04700\",\"R01917\",\"R04702\",\"R01918\",\"R02194\",\"R04701\",\"R02193\"," +
		"\"R01911\",\"R04708\",\"R07236\",\"R04707\",\"R00858\",\"R00859\",\"R00851\"";

	@Override
	public ArrayList<Reaction> getReactions(Collection<String> rxnIds, HashSet<String> dbNames) {

		HashMap<String, Reaction> guid2Reaction = new HashMap<String, Reaction>();
		
		if(rxnIds != null && !rxnIds.isEmpty() && 
				dbNames != null && !dbNames.isEmpty()) {

			String sql = "select R.guid, E.ecNum, R.definition, X.toXrefId, X.xrefDbName " +
			"from glamm.GlammEnzyme E " +
			"right outer join glamm.GlammReaction R on (E.reactionGuid=R.guid) " +
			"join glamm.GlammXref X on (X.fromGuid=R.guid) " +
			"join glamm.GlammEntity2DataSource E2DS on (E2DS.entityGuid=R.guid) " +
			"join glamm.GlammDataSource DS on (DS.guid=E2DS.dataSourceGuid) " +
			"where X.toXrefId in (" + GlammUtils.joinCollection(rxnIds) + ") " + 
			"and DS.dbName in (" + GlammUtils.joinCollection(dbNames) + ");";

			try {

				Connection connection = GlammDbConnectionPool.getConnection();
				Statement statement = connection.createStatement();

				ResultSet rs = statement.executeQuery(sql);

				while(rs.next()) {

					String guid 		= rs.getString("guid");
					String ecNum 		= rs.getString("ecNum");
					String definition 	= rs.getString("definition");
					String xrefId		= rs.getString("toXrefId");
					String xrefDbName	= rs.getString("xrefDbName");
					
					Reaction reaction = guid2Reaction.get(guid);
					if(reaction == null) { 
						reaction = new Reaction();
						reaction.addXref(xrefId, xrefDbName);
						guid2Reaction.put(guid, reaction);
					}
				
					reaction.addEcNum(ecNum);
					reaction.setDefinition(definition);
					
				}

				rs.close();
				connection.close();

			} catch(Exception e) {
				e.printStackTrace();
			}
		}

		if(guid2Reaction.isEmpty())
			return null;
		
		return new ArrayList<Reaction>(guid2Reaction.values());
	}

	@Override
	public ArrayList<Reaction> getReactionsForEcNums(Collection<String> ecNums, HashSet<String> dbNames) {
		ArrayList<Reaction> reactions = null;
		
		if(ecNums != null && !ecNums.isEmpty()) {
			String sql = "select distinct(X.toXrefId), X.xrefDbName, E.ecNum " +
			"from glamm.GlammEnzyme E " +
			"join glamm.GlammXref X on (E.reactionGuid=X.fromGuid) " +
			"where E.ecNum in (" + GlammUtils.joinCollection(ecNums) + ") " +
			"and X.xrefDbName in (" + GlammUtils.joinCollection(dbNames) + ");";
			
			try {

				Connection connection = GlammDbConnectionPool.getConnection();
				Statement statement = connection.createStatement();

				ResultSet rs = statement.executeQuery(sql);

				while(rs.next()) {

					Reaction reaction = new Reaction();
					reaction.addXref(rs.getString("toXrefId"), rs.getString("xrefDbName"));
					reaction.addEcNum(rs.getString("ecNum"));

					if(reactions == null)
						reactions = new ArrayList<Reaction>();
					reactions.add(reaction);
				}

				rs.close();
				connection.close();

			} catch(Exception e) {
				e.printStackTrace();
			}
		}
		
		return reactions;
	}
	
	

	@Override
	public ArrayList<Reaction> getReactionsForSearch(HashSet<String> dbNames) {
	
		// TODO: Generalize for other maps besides global

		HashMap<String, Reaction> guid2Reaction = new HashMap<String, Reaction>();

		if(dbNames != null && !dbNames.isEmpty()) {

			String sql = "select E.reactionGuid, E.ecNum, X.toXrefId, X.xrefDbName " +
			"from glamm.GlammEnzyme E " +
			"join glamm.GlammXref X on (E.reactionGuid=X.fromGuid) " +
			"where X.xrefDbName in (" + GlammUtils.joinCollection(dbNames) + ") " +
			"and X.toXrefId in (" + GLOBAL_MAP_RXN_IDS + ");";

			try {

				Connection connection = GlammDbConnectionPool.getConnection();
				Statement statement = connection.createStatement();

				ResultSet rs = statement.executeQuery(sql);

				while(rs.next()) {


					String guid 		= rs.getString("reactionGuid");
					String ecNum 		= rs.getString("ecNum");
					String xrefId		= rs.getString("toXrefId");
					String xrefDbName	= rs.getString("xrefDbName");
					
					Reaction reaction = guid2Reaction.get(guid);
					if(reaction == null) { 
						reaction = new Reaction();
						guid2Reaction.put(guid, reaction);
					}
				
					reaction.addEcNum(ecNum);
					reaction.addXref(xrefId, xrefDbName);
					
				}

				rs.close();
				connection.close();

			} catch(Exception e) {
				e.printStackTrace();
			}
		}

		if(guid2Reaction.isEmpty())
			return null;
		
		return new ArrayList<Reaction>(guid2Reaction.values());

	}

	public ArrayList<Reaction> getRxn2EcMapping(String mapId, HashSet<String> dbNames) {
		// TODO: Generalize for other maps besides global
		return getReactionsForSearch(dbNames);
	}

	@Override
	public HashSet<String> getRxnIdsForEcNums(Collection<String> ecNums,
			HashSet<String> dbNames) {
		HashSet<String> rxnIds = null;
		
		if(ecNums != null && !ecNums.isEmpty() && dbNames != null && !dbNames.isEmpty()) {
			ArrayList<Reaction> rxns = getReactionsForEcNums(ecNums, dbNames);
			for(Reaction rxn : rxns) {
				HashSet<Xref> xrefs = rxn.getXrefs();
				for(Xref xref : xrefs) {
					if(dbNames.contains(xref.getXrefDbName())) {
						if(rxnIds == null)
							rxnIds = new HashSet<String>();
						rxnIds.add(xref.getXrefId());
					}
				}
			}
		}
		
		return rxnIds;
	}



}
